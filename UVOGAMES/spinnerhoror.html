<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPINERHOROR</title>
    <style>
        :root {
            --primary: #8a2be2;
            --secondary: #4b0082;
            --danger: #dc143c;
            --success: #32cd32;
            --warning: #ff8c00;
            --dark: #1a1a2e;
            --darker: #0f0f1a;
            --light: #e6e6fa;
            --frosted-bg: rgba(255, 255, 255, 0.1);
            --card-bg: rgba(30, 30, 46, 0.8);
            --transition: all 0.3s ease;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--darker), var(--dark));
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .screen {
            display: none;
            width: 100%;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        .header {
            background: var(--frosted-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: flex;
            align-items: center;
        }

        .logo svg {
            margin-right: 10px;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: var(--light);
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-weight: 500;
            box-shadow: var(--shadow);
        }

        .btn:hover, .btn:focus {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .btn-primary:hover, .btn-primary:focus {
            background: linear-gradient(90deg, var(--secondary), var(--primary));
        }

        .btn-danger {
            background: linear-gradient(90deg, var(--danger), #a52a2a);
        }

        .btn-danger:hover, .btn-danger:focus {
            background: linear-gradient(90deg, #a52a2a, var(--danger));
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px 0;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .card-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-align: center;
            color: var(--light);
        }

        .player-setup {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .player-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: var(--transition);
        }

        .player-item.active {
            border: 2px solid var(--primary);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .player-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .player-name {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--light);
            font-size: 1rem;
            padding: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .player-name:focus {
            outline: none;
            border-bottom: 1px solid var(--primary);
        }

        .player-controls {
            display: flex;
            justify-content: space-between;
        }

        .player-controls button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 4px;
            color: var(--light);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .player-controls button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .game-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .option-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .option-select {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 6px;
            color: var(--light);
            padding: 8px 12px;
            cursor: pointer;
        }

        .option-select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary);
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .card-slot {
            aspect-ratio: 3/4;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .card-slot:hover, .card-slot:focus {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-5px);
        }

        .card-slot.selected {
            box-shadow: 0 0 0 3px var(--primary);
        }

        .card-slot.revealed {
            background: rgba(255, 255, 255, 0.2);
        }

        .card-slot.black-card {
            background: linear-gradient(135deg, #1a1a1a, #000);
            color: white;
        }

        .card-content {
            font-size: 1.5rem;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card-slot.revealed .card-content {
            opacity: 1;
        }

        .spinner-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
        }

        .spinner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                var(--primary) 0%,
                var(--secondary) 25%,
                var(--success) 50%,
                var(--warning) 75%,
                var(--danger) 100%
            );
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            transition: transform 3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .spinner::before {
            content: '';
            position: absolute;
            width: 80%;
            height: 80%;
            border-radius: 50%;
            background: var(--dark);
        }

        .spinner-pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: var(--light);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            z-index: 10;
        }

        .spinner-value {
            position: relative;
            z-index: 5;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--light);
        }

        .players-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .player-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            min-width: 150px;
        }

        .player-panel.active {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .player-panel.eliminated {
            opacity: 0.5;
            text-decoration: line-through;
        }

        .player-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .notifications {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 300px;
        }

        .toast {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.danger {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .mobile-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: var(--light);
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .mobile-btn:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        .d-pad {
            grid-column: 2;
            grid-row: 2;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
        }

        .d-pad-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 4px;
            color: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .d-pad-btn:active {
            background: rgba(255, 255, 255, 0.2);
        }

        .d-pad-up {
            grid-column: 2;
            grid-row: 1;
        }

        .d-pad-left {
            grid-column: 1;
            grid-row: 2;
        }

        .d-pad-center {
            grid-column: 2;
            grid-row: 2;
            background: transparent;
        }

        .d-pad-right {
            grid-column: 3;
            grid-row: 2;
        }

        .d-pad-down {
            grid-column: 2;
            grid-row: 3;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .jump-scare {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }

        .jump-scare.active {
            opacity: 1;
            pointer-events: all;
        }

        .jump-scare-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .keyboard-hints {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .key-hint {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 5px 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }

        .key {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 2px 6px;
            font-family: monospace;
            font-weight: bold;
        }

        .credit-content {
            text-align: center;
            line-height: 1.6;
        }

        .developer-name {
            font-size: 1.8rem;
            margin: 20px 0;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(138, 43, 226, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(138, 43, 226, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(138, 43, 226, 0);
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .player-setup {
                grid-template-columns: 1fr;
            }
            
            .game-board {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .mobile-controls {
                display: grid;
            }
            
            .keyboard-hints {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .spinner-container {
                width: 150px;
                height: 150px;
            }
            
            .spinner-value {
                font-size: 2rem;
            }
        }

        .high-contrast {
            --light: #000;
            --dark: #fff;
            --darker: #f0f0f0;
            --frosted-bg: rgba(0, 0, 0, 0.1);
            --card-bg: rgba(255, 255, 255, 0.9);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="url(#gradient)"/>
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#8a2be2"/>
                        <stop offset="100%" stop-color="#4b0082"/>
                    </linearGradient>
                </defs>
            </svg>
            SPINERHOROR
        </div>
        <div class="nav-buttons">
            <button class="btn" id="help-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM15.07 11.25L14.17 12.17C13.45 12.9 13 13.5 13 15H11V14.5C11 13.4 11.45 12.4 12.17 11.67L13.41 10.41C13.78 10.05 14 9.55 14 9C14 7.9 13.1 7 12 7C10.9 7 10 7.9 10 9H8C8 6.79 9.79 5 12 5C14.21 5 16 6.79 16 9C16 9.88 15.64 10.68 15.07 11.25Z" fill="currentColor"/>
                </svg>
                Bantuan
            </button>
            <button class="btn" id="settings-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.14 12.94C19.18 12.64 19.2 12.34 19.2 12C19.2 11.66 19.18 11.36 19.14 11.06L21.16 9.44C21.34 9.3 21.38 9.04 21.26 8.84L19.36 5.8C19.24 5.6 19 5.54 18.8 5.62L16.5 6.68C16.08 6.4 15.62 6.16 15.12 5.98L14.8 3.5C14.78 3.3 14.62 3.14 14.42 3.12H9.58C9.38 3.14 9.22 3.3 9.2 3.5L8.88 5.98C8.38 6.16 7.92 6.4 7.5 6.68L5.2 5.62C5 5.54 4.76 5.6 4.64 5.8L2.74 8.84C2.62 9.04 2.66 9.3 2.84 9.44L4.86 11.06C4.82 11.36 4.8 11.66 4.8 12C4.8 12.34 4.82 12.64 4.86 12.94L2.84 14.56C2.66 14.7 2.62 14.96 2.74 15.16L4.64 18.2C4.76 18.4 5 18.46 5.2 18.38L7.5 17.32C7.92 17.6 8.38 17.84 8.88 18.02L9.2 20.5C9.22 20.7 9.38 20.86 9.58 20.88H14.42C14.62 20.86 14.78 20.7 14.8 20.5L15.12 18.02C15.62 17.84 16.08 17.6 16.5 17.32L18.8 18.38C19 18.46 19.24 18.4 19.36 18.2L21.26 15.16C21.38 14.96 21.34 14.7 21.16 14.56L19.14 12.94ZM12 15.6C10.02 15.6 8.4 13.98 8.4 12C8.4 10.02 10.02 8.4 12 8.4C13.98 8.4 15.6 10.02 15.6 12C15.6 13.98 13.98 15.6 12 15.6Z" fill="currentColor"/>
                </svg>
                Pengaturan
            </button>
        </div>
    </div>

    <div id="lobby" class="screen active">
        <div class="content">
            <div class="card">
                <h2 class="card-title">Setup Pemain</h2>
                <div class="player-setup" id="player-setup"></div>
                <div class="game-options">
                    <div class="option-group">
                        <div class="option-label">Mode Permainan</div>
                        <select class="option-select" id="game-mode">
                            <option value="turn">Mode Urut</option>
                            <option value="random">Mode Acak</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <div class="option-label">Jumlah Kartu</div>
                        <select class="option-select" id="card-count">
                            <option value="8">8 Kartu</option>
                            <option value="12" selected>12 Kartu</option>
                            <option value="16">16 Kartu</option>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="start-game">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 5V19L19 12L8 5Z" fill="currentColor"/>
                        </svg>
                        Mulai Permainan
                    </button>
                </div>
            </div>
            <div class="keyboard-hints">
                <div class="key-hint">
                    <span class="key">1-0</span>
                    <span>Pilih Pemain</span>
                </div>
                <div class="key-hint">
                    <span class="key">Enter</span>
                    <span>Konfirmasi</span>
                </div>
                <div class="key-hint">
                    <span class="key">Spasi</span>
                    <span>Spin</span>
                </div>
                <div class="key-hint">
                    <span class="key">Esc</span>
                    <span>Menu</span>
                </div>
            </div>
        </div>
    </div>

    <div id="game" class="screen">
        <div class="content">
            <div class="players-panel" id="players-panel"></div>
            <div class="game-board" id="game-board"></div>
            <div class="spinner-container">
                <div class="spinner-pointer"></div>
                <div class="spinner" id="spinner">
                    <div class="spinner-value">?</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="spin-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 6V3L16 7L12 11V8C8.69 8 6 10.69 6 14C6 17.31 8.69 20 12 20C15.31 20 18 17.31 18 14H20C20 18.42 16.42 22 12 22C7.58 22 4 18.42 4 14C4 9.58 7.58 6 12 6Z" fill="currentColor"/>
                    </svg>
                    Putar Spinner (Spasi)
                </button>
            </div>
            <div class="mobile-controls">
                <button class="mobile-btn" data-key="1">1</button>
                <button class="mobile-btn" data-key="2">2</button>
                <button class="mobile-btn" data-key="3">3</button>
                <button class="mobile-btn" data-key="4">4</button>
                <div class="d-pad">
                    <button class="d-pad-btn d-pad-up" data-key="ArrowUp">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7.41 15.41L12 10.83L16.59 15.41L18 14L12 8L6 14L7.41 15.41Z" fill="currentColor"/>
                        </svg>
                    </button>
                    <button class="d-pad-btn d-pad-left" data-key="ArrowLeft">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12L15.41 7.41Z" fill="currentColor"/>
                        </svg>
                    </button>
                    <div class="d-pad-center"></div>
                    <button class="d-pad-btn d-pad-right" data-key="ArrowRight">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.59 16.59L10 18L16 12L10 6L8.59 7.41L13.17 12L8.59 16.59Z" fill="currentColor"/>
                        </svg>
                    </button>
                    <button class="d-pad-btn d-pad-down" data-key="ArrowDown">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7.41 8.59L12 13.17L16.59 8.59L18 10L12 16L6 10L7.41 8.59Z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>
                <button class="mobile-btn" data-key="5">5</button>
                <button class="mobile-btn" data-key="6">6</button>
                <button class="mobile-btn" data-key="7">7</button>
                <button class="mobile-btn" data-key="8">8</button>
                <button class="mobile-btn" data-key="Enter">Buka</button>
                <button class="mobile-btn" data-key=" ">Spin</button>
                <button class="mobile-btn" data-key="9">9</button>
                <button class="mobile-btn" data-key="0">10</button>
            </div>
            <div class="keyboard-hints">
                <div class="key-hint">
                    <span class="key">←↑→↓</span>
                    <span>Navigasi Kartu</span>
                </div>
                <div class="key-hint">
                    <span class="key">Enter</span>
                    <span>Buka Kartu</span>
                </div>
                <div class="key-hint">
                    <span class="key">Spasi</span>
                    <span>Putar Spinner</span>
                </div>
                <div class="key-hint">
                    <span class="key">1-0</span>
                    <span>Pilih Kartu Cepat</span>
                </div>
            </div>
        </div>
    </div>

    <div id="pause" class="screen">
        <div class="content">
            <div class="card">
                <h2 class="card-title">Menu Jeda</h2>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="resume-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 5V19L19 12L8 5Z" fill="currentColor"/>
                        </svg>
                        Lanjutkan
                    </button>
                    <button class="btn" id="restart-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4C7.58 4 4 7.58 4 12C4 16.42 7.58 20 12 20C15.73 20 18.84 17.45 19.73 14H17.65C16.83 16.33 14.61 18 12 18C8.69 18 6 15.31 6 12C6 8.69 8.69 6 12 6C13.66 6 15.14 6.69 16.22 7.78L13 11H20V4L17.65 6.35Z" fill="currentColor"/>
                        </svg>
                        Mulai Ulang
                    </button>
                    <button class="btn" id="credit-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10C8 12.21 9.79 14 12 14C14.21 14 16 12.21 16 10C16 7.79 14.21 6 12 6ZM12 12C10.9 12 10 11.1 10 10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 11.1 13.1 12 12 12ZM12 16C9.33 16 4 17.34 4 20V22H20V20C20 17.34 14.67 16 12 16ZM12.1 18C13 18 16.9 18.81 17.9 20H6.1C7.1 18.81 11.2 18 12.1 18Z" fill="currentColor"/>
                        </svg>
                        Kredit
                    </button>
                    <button class="btn btn-danger" id="quit-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
                        </svg>
                        Keluar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="credit" class="screen">
        <div class="content">
            <div class="card">
                <div class="credit-content">
                    <h2 class="card-title">SPINERHOROR</h2>
                    <div class="developer-name">Developer By: ADITdeveloper</div>
                    <p>Game horor dengan mekanik spinner dan kartu misteri.</p>
                    <p>Setiap pemain harus berhati-hati memilih kartu untuk menghindari kartu hitam yang mematikan!</p>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="back-from-credit">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 11H7.83L13.42 5.41L12 4L4 12L12 20L13.41 18.59L7.83 13H20V11Z" fill="currentColor"/>
                        </svg>
                        Kembali
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="notifications" id="notifications"></div>

    <div class="modal" id="help-modal">
        <div class="modal-content">
            <h2 class="modal-title">Bantuan & Kontrol</h2>
            <div class="option-group">
                <h3>Kontrol Desktop</h3>
                <p><span class="key">1-0</span> - Pilih pemain atau kartu cepat</p>
                <p><span class="key">← ↑ → ↓</span> - Navigasi antar kartu</p>
                <p><span class="key">Enter</span> - Buka kartu yang dipilih</p>
                <p><span class="key">Spasi</span> - Putar spinner</p>
                <p><span class="key">Esc</span> - Buka menu jeda</p>
            </div>
            <div class="option-group">
                <h3>Kontrol Mobile</h3>
                <p>Gunakan tombol di layar untuk navigasi dan aksi</p>
            </div>
            <div class="option-group">
                <h3>Kontrol Gamepad</h3>
                <p><span class="key">D-Pad</span> - Navigasi</p>
                <p><span class="key">A</span> - Konfirmasi / Buka kartu</p>
                <p><span class="key">X / Start</span> - Putar spinner</p>
            </div>
            <div class="option-group">
                <h3>Aturan Permainan</h3>
                <p>1. Setiap pemain memutar spinner untuk menentukan berapa kartu yang bisa dibuka</p>
                <p>2. Pemain memilih kartu sesuai jumlah dari spinner</p>
                <p>3. Jika spinner &lt; 4, sistem akan memilih sisanya secara acak</p>
                <p>4. Jika kartu hitam terbuka, pemain langsung tereliminasi</p>
                <p>5. Pemain terakhir yang bertahan adalah pemenang</p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="close-help">Tutup</button>
            </div>
        </div>
    </div>

    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <h2 class="modal-title">Pengaturan</h2>
            <div class="option-group">
                <label>
                    <input type="checkbox" id="jump-scare-toggle" checked>
                    Aktifkan Jump Scare
                </label>
            </div>
            <div class="option-group">
                <div class="option-label">Volume Suara</div>
                <input type="range" id="volume-slider" min="0" max="100" value="50">
            </div>
            <div class="option-group">
                <label>
                    <input type="checkbox" id="high-contrast-toggle">
                    Mode Kontras Tinggi
                </label>
            </div>
            <div class="option-group">
                <label>
                    <input type="checkbox" id="fullscreen-toggle">
                    Layar Penuh
                </label>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="close-settings">Simpan</button>
            </div>
        </div>
    </div>

    <div class="jump-scare" id="jump-scare">
        <img class="jump-scare-img" id="jump-scare-img" src="" alt="Jump Scare">
        <audio id="jump-scare-audio" preload="none"></audio>
    </div>

    <script>
        const CONFIG = {
            title: "SPINERHOROR",
            developer: "ADITdeveloper",
            maxPlayers: 10,
            spinnerRange: [1,4],
            defaultCardsCount: 12,
            jumpScare: {
                enabled: true,
                imageUrl: "",
                audioUrl: ""
            },
            controls: { keyboardOnly: true, allowMouse: false }
        };

        const state = {
            currentScreen: 'lobby',
            players: [],
            currentPlayerIndex: 0,
            cards: [],
            selectedCardIndex: -1,
            spinnerValue: 0,
            attemptsLeft: 0,
            gameMode: 'turn',
            cardCount: 12,
            blackCardIndex: -1,
            gameStarted: false,
            eliminatedPlayers: []
        };

        const elements = {
            lobby: document.getElementById('lobby'),
            game: document.getElementById('game'),
            pause: document.getElementById('pause'),
            credit: document.getElementById('credit'),
            playerSetup: document.getElementById('player-setup'),
            playersPanel: document.getElementById('players-panel'),
            gameBoard: document.getElementById('game-board'),
            spinner: document.getElementById('spinner'),
            spinBtn: document.getElementById('spin-btn'),
            startGame: document.getElementById('start-game'),
            resumeBtn: document.getElementById('resume-btn'),
            restartBtn: document.getElementById('restart-btn'),
            creditBtn: document.getElementById('credit-btn'),
            quitBtn: document.getElementById('quit-btn'),
            backFromCredit: document.getElementById('back-from-credit'),
            helpBtn: document.getElementById('help-btn'),
            settingsBtn: document.getElementById('settings-btn'),
            helpModal: document.getElementById('help-modal'),
            settingsModal: document.getElementById('settings-modal'),
            closeHelp: document.getElementById('close-help'),
            closeSettings: document.getElementById('close-settings'),
            notifications: document.getElementById('notifications'),
            jumpScare: document.getElementById('jump-scare'),
            jumpScareImg: document.getElementById('jump-scare-img'),
            jumpScareAudio: document.getElementById('jump-scare-audio'),
            gameMode: document.getElementById('game-mode'),
            cardCount: document.getElementById('card-count'),
            jumpScareToggle: document.getElementById('jump-scare-toggle'),
            volumeSlider: document.getElementById('volume-slider'),
            highContrastToggle: document.getElementById('high-contrast-toggle'),
            fullscreenToggle: document.getElementById('fullscreen-toggle')
        };

        const colors = [
            '#FF5252', '#FF4081', '#E040FB', '#7C4DFF', 
            '#536DFE', '#448AFF', '#40C4FF', '#18FFFF',
            '#64FFDA', '#69F0AE', '#B2FF59', '#EEFF41'
        ];

        function init() {
            setupEventListeners();
            initializePlayers();
            loadSettings();
        }

        function setupEventListeners() {
            document.addEventListener('keydown', handleKeyDown);
            
            elements.startGame.addEventListener('click', startGame);
            elements.spinBtn.addEventListener('click', spinSpinner);
            elements.resumeBtn.addEventListener('click', resumeGame);
            elements.restartBtn.addEventListener('click', restartGame);
            elements.creditBtn.addEventListener('click', showCredit);
            elements.quitBtn.addEventListener('click', quitToLobby);
            elements.backFromCredit.addEventListener('click', backFromCredit);
            elements.helpBtn.addEventListener('click', showHelp);
            elements.settingsBtn.addEventListener('click', showSettings);
            elements.closeHelp.addEventListener('click', closeHelp);
            elements.closeSettings.addEventListener('click', closeSettings);
            
            elements.gameMode.addEventListener('change', (e) => {
                state.gameMode = e.target.value;
                saveSettings();
            });
            
            elements.cardCount.addEventListener('change', (e) => {
                state.cardCount = parseInt(e.target.value);
                saveSettings();
            });
            
            elements.jumpScareToggle.addEventListener('change', (e) => {
                CONFIG.jumpScare.enabled = e.target.checked;
                saveSettings();
            });
            
            elements.volumeSlider.addEventListener('input', (e) => {
                elements.jumpScareAudio.volume = e.target.value / 100;
                saveSettings();
            });
            
            elements.highContrastToggle.addEventListener('change', (e) => {
                document.body.classList.toggle('high-contrast', e.target.checked);
                saveSettings();
            });
            
            elements.fullscreenToggle.addEventListener('change', toggleFullscreen);
            
            document.querySelectorAll('.mobile-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const key = e.currentTarget.getAttribute('data-key');
                    handleMobileInput(key);
                });
            });
            
            document.addEventListener('gamepadconnected', (e) => {
                showNotification('Gamepad terdeteksi!', 'success');
            });
            
            document.addEventListener('gamepaddisconnected', (e) => {
                showNotification('Gamepad terputus', 'warning');
            });
            
            requestAnimationFrame(updateGamepad);
        }

        function initializePlayers() {
            state.players = [];
            for (let i = 0; i < 4; i++) {
                addPlayer();
            }
            renderPlayerSetup();
        }

        function addPlayer() {
            if (state.players.length >= CONFIG.maxPlayers) return;
            
            const player = {
                id: state.players.length + 1,
                name: `Pemain ${state.players.length + 1}`,
                color: colors[state.players.length % colors.length],
                active: true,
                eliminated: false
            };
            
            state.players.push(player);
            renderPlayerSetup();
        }

        function removePlayer(index) {
            if (state.players.length <= 1) return;
            state.players.splice(index, 1);
            renderPlayerSetup();
        }

        function renderPlayerSetup() {
            elements.playerSetup.innerHTML = '';
            
            state.players.forEach((player, index) => {
                const playerElement = document.createElement('div');
                playerElement.className = 'player-item';
                playerElement.innerHTML = `
                    <div class="player-header">
                        <div class="player-color" style="background-color: ${player.color}"></div>
                        <input type="text" class="player-name" value="${player.name}" maxlength="16" data-index="${index}">
                    </div>
                    <div class="player-controls">
                        <button class="color-picker" data-index="${index}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2ZM16 13H13V16C13 16.55 12.55 17 12 17C11.45 17 11 16.55 11 16V13H8C7.45 13 7 12.55 7 12C7 11.45 7.45 11 8 11H11V8C11 7.45 11.45 7 12 7C12.55 7 13 7.45 13 8V11H16C16.55 11 17 11.45 17 12C17 12.55 16.55 13 16 13Z" fill="currentColor"/>
                            </svg>
                        </button>
                        <button class="remove-player" data-index="${index}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
                            </svg>
                        </button>
                    </div>
                `;
                
                elements.playerSetup.appendChild(playerElement);
                
                const nameInput = playerElement.querySelector('.player-name');
                const colorPicker = playerElement.querySelector('.color-picker');
                const removeBtn = playerElement.querySelector('.remove-player');
                
                nameInput.addEventListener('input', (e) => {
                    state.players[index].name = e.target.value;
                    saveSettings();
                });
                
                colorPicker.addEventListener('click', () => {
                    changePlayerColor(index);
                });
                
                removeBtn.addEventListener('click', () => {
                    removePlayer(index);
                });
            });
            
            const addPlayerBtn = document.createElement('div');
            addPlayerBtn.className = 'player-item';
            addPlayerBtn.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <button class="btn" id="add-player-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
                        </svg>
                    </button>
                    <div>Tambah Pemain</div>
                </div>
            `;
            
            elements.playerSetup.appendChild(addPlayerBtn);
            
            document.getElementById('add-player-btn').addEventListener('click', () => {
                addPlayer();
            });
        }

        function changePlayerColor(index) {
            const currentColor = state.players[index].color;
            const currentColorIndex = colors.indexOf(currentColor);
            const nextColorIndex = (currentColorIndex + 1) % colors.length;
            state.players[index].color = colors[nextColorIndex];
            renderPlayerSetup();
            saveSettings();
        }

        function startGame() {
            if (state.players.length < 1) {
                showNotification('Minimal 1 pemain diperlukan', 'warning');
                return;
            }
            
            state.gameStarted = true;
            state.currentPlayerIndex = 0;
            state.eliminatedPlayers = [];
            state.blackCardIndex = -1;
            
            initializeCards();
            renderGameBoard();
            renderPlayersPanel();
            
            showScreen('game');
            showNotification('Permainan dimulai!', 'success');
            
            updateCurrentPlayer();
        }

        function initializeCards() {
            state.cards = [];
            const totalCards = state.cardCount;
            state.blackCardIndex = Math.floor(Math.random() * totalCards);
            
            for (let i = 0; i < totalCards; i++) {
                state.cards.push({
                    index: i,
                    revealed: false,
                    isBlack: i === state.blackCardIndex,
                    value: i === state.blackCardIndex ? '☠' : getRandomCardValue()
                });
            }
        }

        function getRandomCardValue() {
            const values = ['★', '◆', '●', '▲', '♠', '♥', '♣', '♦'];
            return values[Math.floor(Math.random() * values.length)];
        }

        function renderGameBoard() {
            elements.gameBoard.innerHTML = '';
            
            state.cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card-slot';
                if (card.revealed) {
                    cardElement.classList.add('revealed');
                    if (card.isBlack) {
                        cardElement.classList.add('black-card');
                    }
                }
                if (index === state.selectedCardIndex) {
                    cardElement.classList.add('selected');
                }
                
                cardElement.innerHTML = `
                    <div class="card-content">${card.revealed ? card.value : '?'}</div>
                `;
                
                cardElement.addEventListener('click', () => {
                    if (state.attemptsLeft > 0 && !card.revealed) {
                        selectCard(index);
                    }
                });
                
                elements.gameBoard.appendChild(cardElement);
            });
        }

        function renderPlayersPanel() {
            elements.playersPanel.innerHTML = '';
            
            state.players.forEach((player, index) => {
                const playerElement = document.createElement('div');
                playerElement.className = 'player-panel';
                if (index === state.currentPlayerIndex && !player.eliminated) {
                    playerElement.classList.add('active');
                    playerElement.classList.add('pulse');
                }
                if (player.eliminated) {
                    playerElement.classList.add('eliminated');
                }
                
                playerElement.innerHTML = `
                    <div class="player-indicator" style="background-color: ${player.color}"></div>
                    <div class="player-name">${player.name}</div>
                `;
                
                elements.playersPanel.appendChild(playerElement);
            });
        }

        function spinSpinner() {
            if (state.attemptsLeft > 0) return;
            
            const min = CONFIG.spinnerRange[0];
            const max = CONFIG.spinnerRange[1];
            const result = Math.floor(Math.random() * (max - min + 1)) + min;
            
            elements.spinner.style.transform = `rotate(${1080 + result * 90}deg)`;
            
            setTimeout(() => {
                state.spinnerValue = result;
                state.attemptsLeft = result;
                elements.spinner.querySelector('.spinner-value').textContent = result;
                showNotification(`${state.players[state.currentPlayerIndex].name} dapat ${result} kesempatan`, 'success');
            }, 3000);
        }

        function selectCard(index) {
            if (state.attemptsLeft <= 0 || state.cards[index].revealed) return;
            
            state.selectedCardIndex = index;
            renderGameBoard();
            
            setTimeout(() => {
                revealCard(index);
            }, 500);
        }

        function revealCard(index) {
            const card = state.cards[index];
            card.revealed = true;
            
            if (card.isBlack) {
                showNotification(`${state.players[state.currentPlayerIndex].name} menemukan kartu hitam!`, 'danger');
                triggerJumpScare();
                eliminateCurrentPlayer();
            } else {
                showNotification(`${state.players[state.currentPlayerIndex].name} membuka kartu aman`, 'success');
            }
            
            state.attemptsLeft--;
            renderGameBoard();
            
            if (state.attemptsLeft <= 0) {
                autoRevealRemainingCards();
            }
            
            checkGameEnd();
        }

        function autoRevealRemainingCards() {
            const totalPicks = 4;
            const revealedCount = state.cards.filter(card => card.revealed).length;
            const remainingPicks = totalPicks - revealedCount;
            
            if (remainingPicks > 0) {
                showNotification(`Sistem memilih ${remainingPicks} kartu secara acak`, 'warning');
                
                let picks = 0;
                const autoPickInterval = setInterval(() => {
                    if (picks >= remainingPicks) {
                        clearInterval(autoPickInterval);
                        endTurn();
                        return;
                    }
                    
                    const unrevealedCards = state.cards
                        .map((card, index) => ({card, index}))
                        .filter(({card}) => !card.revealed);
                    
                    if (unrevealedCards.length === 0) {
                        clearInterval(autoPickInterval);
                        endTurn();
                        return;
                    }
                    
                    const randomIndex = Math.floor(Math.random() * unrevealedCards.length);
                    const cardToReveal = unrevealedCards[randomIndex];
                    
                    cardToReveal.card.revealed = true;
                    
                    if (cardToReveal.card.isBlack) {
                        showNotification(`Kartu otomatis adalah kartu hitam!`, 'danger');
                        triggerJumpScare();
                        eliminateCurrentPlayer();
                        clearInterval(autoPickInterval);
                        checkGameEnd();
                        return;
                    }
                    
                    renderGameBoard();
                    picks++;
                }, 1000);
            } else {
                endTurn();
            }
        }

        function eliminateCurrentPlayer() {
            const player = state.players[state.currentPlayerIndex];
            player.eliminated = true;
            player.active = false;
            state.eliminatedPlayers.push(player);
            
            showNotification(`${player.name} tereliminasi!`, 'danger');
            renderPlayersPanel();
        }

        function endTurn() {
            if (state.players.filter(p => !p.eliminated).length <= 1) {
                endGame();
                return;
            }
            
            do {
                if (state.gameMode === 'turn') {
                    state.currentPlayerIndex = (state.currentPlayerIndex + 1) % state.players.length;
                } else {
                    const activePlayers = state.players
                        .map((player, index) => ({player, index}))
                        .filter(({player}) => !player.eliminated);
                    
                    if (activePlayers.length > 0) {
                        const randomPlayer = activePlayers[Math.floor(Math.random() * activePlayers.length)];
                        state.currentPlayerIndex = randomPlayer.index;
                    }
                }
            } while (state.players[state.currentPlayerIndex].eliminated);
            
            state.attemptsLeft = 0;
            state.selectedCardIndex = -1;
            updateCurrentPlayer();
        }

        function updateCurrentPlayer() {
            renderPlayersPanel();
            showNotification(`Giliran ${state.players[state.currentPlayerIndex].name}`, 'success');
        }

        function checkGameEnd() {
            const activePlayers = state.players.filter(p => !p.eliminated);
            if (activePlayers.length === 1) {
                endGame();
            }
        }

        function endGame() {
            const winner = state.players.find(p => !p.eliminated);
            if (winner) {
                showNotification(`${winner.name} menang!`, 'success');
                setTimeout(() => {
                    alert(`Permainan berakhir! Pemenang: ${winner.name}`);
                    quitToLobby();
                }, 2000);
            }
        }

        function triggerJumpScare() {
            if (!CONFIG.jumpScare.enabled) return;
            
            elements.jumpScare.classList.add('active');
            
            if (CONFIG.jumpScare.audioUrl) {
                elements.jumpScareAudio.src = CONFIG.jumpScare.audioUrl;
                elements.jumpScareAudio.play().catch(e => {
                    console.log('Audio tidak dapat diputar: ', e);
                });
            }
            
            if (CONFIG.jumpScare.imageUrl) {
                elements.jumpScareImg.src = CONFIG.jumpScare.imageUrl;
            }
            
            setTimeout(() => {
                elements.jumpScare.classList.remove('active');
            }, 3000);
        }

        function handleKeyDown(e) {
            if (state.currentScreen === 'game') {
                handleGameInput(e);
            } else if (state.currentScreen === 'lobby') {
                handleLobbyInput(e);
            }
            
            if (e.key === 'Escape') {
                if (state.currentScreen === 'game') {
                    showScreen('pause');
                } else if (state.currentScreen === 'pause') {
                    resumeGame();
                }
            }
        }

        function handleGameInput(e) {
            switch(e.key) {
                case 'ArrowLeft':
                    navigateCards(-1);
                    break;
                case 'ArrowRight':
                    navigateCards(1);
                    break;
                case 'ArrowUp':
                    navigateCards(-4);
                    break;
                case 'ArrowDown':
                    navigateCards(4);
                    break;
                case 'Enter':
                    if (state.selectedCardIndex >= 0 && state.attemptsLeft > 0) {
                        selectCard(state.selectedCardIndex);
                    }
                    break;
                case ' ':
                    if (state.attemptsLeft === 0) {
                        spinSpinner();
                    }
                    break;
                case '1': case '2': case '3': case '4': 
                case '5': case '6': case '7': case '8': 
                case '9': case '0':
                    const num = e.key === '0' ? 9 : parseInt(e.key) - 1;
                    if (num < state.cards.length && state.attemptsLeft > 0) {
                        selectCard(num);
                    }
                    break;
            }
        }

        function handleLobbyInput(e) {
            if (e.key >= '1' && e.key <= '9') {
                const index = parseInt(e.key) - 1;
                if (index < state.players.length) {
                    document.querySelectorAll('.player-name')[index].focus();
                }
            } else if (e.key === '0' && state.players.length === 10) {
                document.querySelectorAll('.player-name')[9].focus();
            } else if (e.key === 'Enter') {
                startGame();
            }
        }

        function handleMobileInput(key) {
            const event = new KeyboardEvent('keydown', { key });
            document.dispatchEvent(event);
        }

        function navigateCards(direction) {
            if (state.cards.length === 0) return;
            
            let newIndex = state.selectedCardIndex + direction;
            
            if (newIndex < 0) newIndex = state.cards.length - 1;
            if (newIndex >= state.cards.length) newIndex = 0;
            
            state.selectedCardIndex = newIndex;
            renderGameBoard();
        }

        function showScreen(screenName) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            state.currentScreen = screenName;
            document.getElementById(screenName).classList.add('active');
        }

        function resumeGame() {
            showScreen('game');
        }

        function restartGame() {
            if (confirm('Mulai ulang permainan?')) {
                startGame();
            }
        }

        function showCredit() {
            showScreen('credit');
        }

        function quitToLobby() {
            state.gameStarted = false;
            showScreen('lobby');
        }

        function backFromCredit() {
            showScreen('pause');
        }

        function showHelp() {
            elements.helpModal.classList.add('active');
        }

        function showSettings() {
            elements.settingsModal.classList.add('active');
        }

        function closeHelp() {
            elements.helpModal.classList.remove('active');
        }

        function closeSettings() {
            elements.settingsModal.classList.remove('active');
        }

        function showNotification(message, type = '') {
            const notification = document.createElement('div');
            notification.className = `toast ${type}`;
            notification.textContent = message;
            
            elements.notifications.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function updateGamepad() {
            const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
            
            for (const gamepad of gamepads) {
                if (!gamepad) continue;
                
                if (gamepad.buttons[0].pressed) {
                    handleMobileInput('Enter');
                }
                
                if (gamepad.buttons[2].pressed || gamepad.buttons[9].pressed) {
                    handleMobileInput(' ');
                }
                
                if (gamepad.axes[0] < -0.5) {
                    handleMobileInput('ArrowLeft');
                } else if (gamepad.axes[0] > 0.5) {
                    handleMobileInput('ArrowRight');
                }
                
                if (gamepad.axes[1] < -0.5) {
                    handleMobileInput('ArrowUp');
                } else if (gamepad.axes[1] > 0.5) {
                    handleMobileInput('ArrowDown');
                }
            }
            
            requestAnimationFrame(updateGamepad);
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        function saveSettings() {
            const settings = {
                players: state.players,
                gameMode: state.gameMode,
                cardCount: state.cardCount,
                jumpScareEnabled: CONFIG.jumpScare.enabled,
                volume: elements.volumeSlider.value,
                highContrast: elements.highContrastToggle.checked
            };
            
            localStorage.setItem('spinerhoror-settings', JSON.stringify(settings));
        }

        function loadSettings() {
            const saved = localStorage.getItem('spinerhoror-settings');
            if (saved) {
                const settings = JSON.parse(saved);
                
                if (settings.players) {
                    state.players = settings.players;
                    renderPlayerSetup();
                }
                
                if (settings.gameMode) {
                    state.gameMode = settings.gameMode;
                    elements.gameMode.value = settings.gameMode;
                }
                
                if (settings.cardCount) {
                    state.cardCount = settings.cardCount;
                    elements.cardCount.value = settings.cardCount;
                }
                
                if (settings.jumpScareEnabled !== undefined) {
                    CONFIG.jumpScare.enabled = settings.jumpScareEnabled;
                    elements.jumpScareToggle.checked = settings.jumpScareEnabled;
                }
                
                if (settings.volume) {
                    elements.volumeSlider.value = settings.volume;
                    elements.jumpScareAudio.volume = settings.volume / 100;
                }
                
                if (settings.highContrast !== undefined) {
                    elements.highContrastToggle.checked = settings.highContrast;
                    document.body.classList.toggle('high-contrast', settings.highContrast);
                }
            }
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
