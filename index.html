<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toko Voucher Game Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #334155;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border: #475569;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --radius: 8px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: var(--bg-secondary);
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        .logo img {
            height: 40px;
            width: auto;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        nav a {
            color: var(--text-primary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            transition: background 0.3s;
        }

        nav a:hover, nav a.active {
            background-color: var(--bg-card);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--accent);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        /* Main Content */
        main {
            padding: 2rem 0;
            min-height: calc(100vh - 140px);
        }

        .section-title {
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Footer */
        footer {
            background-color: var(--bg-secondary);
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--accent);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-links a {
            color: var(--text-primary);
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .social-links a:hover {
            color: var(--accent);
        }

        .copyright {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
        }

        /* Utility */
        .btn {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background-color: var(--accent-hover);
        }

        .btn-secondary {
            background-color: var(--bg-card);
        }

        .btn-secondary:hover {
            background-color: var(--border);
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #0da271;
        }

        .btn-block {
            width: 100%;
        }

        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
        }

        .error {
            background-color: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 1rem;
            border-radius: var(--radius);
            margin: 1rem 0;
        }

        .success {
            background-color: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
            padding: 1rem;
            border-radius: var(--radius);
            margin: 1rem 0;
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .product-card {
            background-color: var(--bg-card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            height: 180px;
            background-color: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-badges {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .badge {
            background-color: var(--accent);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge.recommend {
            background-color: var(--success);
        }

        .badge.hot {
            background-color: var(--danger);
        }

        .product-name {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .product-publisher {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
            margin: 1rem 0;
        }

        /* Checkout */
        .checkout-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }
        }

        .checkout-form, .order-summary {
            background-color: var(--bg-card);
            padding: 1.5rem;
            border-radius: var(--radius);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
        }

        .cart-items {
            margin-bottom: 1.5rem;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .payment-method:hover, .payment-method.selected {
            border-color: var(--accent);
        }

        .payment-method input[type="radio"] {
            margin: 0;
        }

        .payment-logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
        }

        .payment-details {
            flex-grow: 1;
        }

        .payment-name {
            font-weight: 600;
        }

        .payment-fee {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .payment-instructions {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
        }

        .payment-instructions ol {
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .payment-instructions li {
            margin-bottom: 0.5rem;
        }

        .qr-container {
            text-align: center;
            margin: 1.5rem 0;
        }

        .qr-container img {
            max-width: 200px;
            border-radius: var(--radius);
            margin-bottom: 1rem;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal {
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            line-height: 1;
        }

        /* Order History */
        .orders-list {
            margin-top: 1.5rem;
        }

        .order-card {
            background-color: var(--bg-card);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .order-id {
            font-weight: bold;
            color: var(--accent);
        }

        .order-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .status-pending {
            background-color: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .status-completed {
            background-color: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .status-cancelled {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        /* Maintenance Banner */
        .maintenance-banner {
            background-color: var(--warning);
            color: #000;
            text-align: center;
            padding: 1rem;
            font-weight: 600;
            position: sticky;
            top: 72px;
            z-index: 99;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
            }
            
            nav {
                order: 3;
                width: 100%;
                margin-top: 1rem;
            }
            
            nav ul {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .mobile-menu {
                display: none;
            }
            
            .mobile-menu.active {
                display: block;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--accent) 0%, var(--bg-secondary) 100%);
            padding: 4rem 0;
            border-radius: var(--radius);
            margin-bottom: 3rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
            color: var(--text-secondary);
        }

        /* Search & Filter */
        .search-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .search-box {
            flex-grow: 1;
            min-width: 250px;
        }

        .filter-category {
            min-width: 200px;
        }

        /* Admin Override */
        .admin-override {
            background-color: var(--bg-card);
            padding: 1rem;
            border-radius: var(--radius);
            margin-top: 2rem;
            border-left: 4px solid var(--accent);
        }

        .admin-override h4 {
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .admin-override p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-gamepad"></i>
                    <span id="site-name">GameStore</span>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav class="mobile-menu" id="mainNav">
                    <ul>
                        <li><a href="#home" class="nav-link active">Beranda</a></li>
                        <li><a href="#products" class="nav-link">Produk</a></li>
                        <li><a href="#promo" class="nav-link">Promo</a></li>
                        <li><a href="#membership" class="nav-link">Membership</a></li>
                        <li><a href="#support" class="nav-link">Bantuan</a></li>
                        <li><a href="#history" class="nav-link">Riwayat</a></li>
                    </ul>
                </nav>
                
                <div class="cart-icon" id="cartIcon">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cartCount">0</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Maintenance Banner (hidden by default) -->
    <div class="maintenance-banner hidden" id="maintenanceBanner">
        <i class="fas fa-tools"></i> Situs sedang dalam perbaikan. Pembelian sementara dinonaktifkan.
    </div>

    <!-- Main Content -->
    <main>
        <div class="container">
            <div id="app-content">
                <!-- Content will be rendered here by JavaScript -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Memuat data...
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content" id="footer-content">
                <!-- Footer content will be populated from JSON -->
            </div>
            <div class="copyright">
                <p id="copyright-text">© 2023 GameStore. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Modal -->
    <div class="modal-overlay hidden" id="waModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Pesanan Berhasil Dibuat!</h3>
                <button class="close-modal" id="closeWaModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Pesanan Anda telah disimpan. Silakan kirim pesan ke WhatsApp admin untuk melanjutkan pembayaran.</p>
                <div class="success">
                    <p><strong>ID Pesanan:</strong> <span id="modalOrderId"></span></p>
                    <p><strong>Total Pembayaran:</strong> <span id="modalOrderTotal"></span></p>
                </div>
                <p>Pesan WhatsApp telah disiapkan dengan detail pesanan Anda. Klik tombol di bawah untuk membuka WhatsApp.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="copyMessageBtn">
                    <i class="far fa-copy"></i> Salin Pesan
                </button>
                <button class="btn btn-success" id="openWhatsAppBtn">
                    <i class="fab fa-whatsapp"></i> Buka WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div class="modal-overlay hidden" id="cartModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Keranjang Belanja</h3>
                <button class="close-modal" id="closeCartModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cartItemsContainer">
                    <!-- Cart items will be populated here -->
                </div>
                <div class="text-center" id="emptyCartMessage">
                    <p>Keranjang belanja kosong</p>
                    <a href="#products" class="btn btn-secondary mt-2">Lihat Produk</a>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="continueShoppingBtn">Lanjut Belanja</button>
                <button class="btn" id="checkoutBtn">Checkout</button>
            </div>
        </div>
    </div>

    <!-- Admin Override Panel -->
    <div class="admin-override hidden" id="adminOverridePanel">
        <h4><i class="fas fa-user-cog"></i> Mode Pengembang</h4>
        <p>Gunakan fitur ini untuk menguji dengan nomor WhatsApp berbeda. Perubahan hanya disimpan di browser ini.</p>
        <div class="form-group">
            <label for="overrideWhatsapp">Nomor WhatsApp Admin (tanpa +):</label>
            <input type="text" id="overrideWhatsapp" class="form-control" placeholder="6285311111010">
            <small>Kosongkan untuk menggunakan nomor dari server</small>
        </div>
        <button class="btn btn-secondary" id="saveOverrideBtn">Simpan Perubahan</button>
    </div>

    <script>
        // State management
        const state = {
            siteData: null,
            cart: JSON.parse(localStorage.getItem('adit_cart')) || [],
            orders: JSON.parse(localStorage.getItem('adit_orders')) || [],
            currentPage: 'home',
            selectedPayment: null,
            adminOverride: JSON.parse(localStorage.getItem('adit_config_override')) || {}
        };

        // DOM elements
        const appContent = document.getElementById('app-content');
        const cartCount = document.getElementById('cartCount');
        const cartIcon = document.getElementById('cartIcon');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mainNav = document.getElementById('mainNav');
        const maintenanceBanner = document.getElementById('maintenanceBanner');
        const footerContent = document.getElementById('footer-content');
        const copyrightText = document.getElementById('copyright-text');
        const siteName = document.getElementById('site-name');
        const adminOverridePanel = document.getElementById('adminOverridePanel');
        const saveOverrideBtn = document.getElementById('saveOverrideBtn');
        const overrideWhatsapp = document.getElementById('overrideWhatsapp');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Load data from JSON
                await loadSiteData();
                
                // Initialize UI
                updateCartCount();
                renderPage();
                setupEventListeners();
                setupNavigation();
                
                // Show admin override panel if in development mode
                if (window.location.hash === '#dev') {
                    adminOverridePanel.classList.remove('hidden');
                    if (state.adminOverride.whatsapp_number) {
                        overrideWhatsapp.value = state.adminOverride.whatsapp_number;
                    }
                }
                
            } catch (error) {
                console.error('Failed to initialize app:', error);
                showError('Gagal memuat data. Silakan refresh halaman.');
            }
        });

        // Load site data from ADITdeveloper.json
        async function loadSiteData() {
            try {
                const response = await fetch('/ADITdeveloper.json');
                if (!response.ok) throw new Error('Network response was not ok');
                
                state.siteData = await response.json();
                
                // Update site name
                siteName.textContent = state.siteData.site.shortName || state.siteData.site.name;
                
                // Update copyright
                copyrightText.textContent = `© ${new Date().getFullYear()} ${state.siteData.site.name}. All rights reserved.`;
                
                // Check site status
                checkSiteStatus();
                
                // Render footer
                renderFooter();
                
            } catch (error) {
                console.error('Error loading site data:', error);
                throw error;
            }
        }

        // Check site status and show maintenance banner if needed
        function checkSiteStatus() {
            if (!state.siteData) return;
            
            const status = state.siteData.site.status;
            if (status === 'maintenance' || status === 'closed') {
                maintenanceBanner.classList.remove('hidden');
                
                let message = '';
                if (status === 'maintenance') {
                    message = 'Situs sedang dalam perbaikan. Pembelian sementara dinonaktifkan.';
                } else {
                    message = 'Situs sedang tutup. Pembelian dinonaktifkan.';
                }
                
                maintenanceBanner.innerHTML = `<i class="fas fa-tools"></i> ${message}`;
            }
        }

        // Render footer content from site data
        function renderFooter() {
            if (!state.siteData) return;
            
            const social = state.siteData.social || {};
            const openHours = state.siteData.open_hours || {};
            
            let html = `
                <div class="footer-section">
                    <h3>${state.siteData.site.name}</h3>
                    <p>${state.siteData.site.description}</p>
                    <div class="social-links">
                        ${social.facebook ? `<a href="${social.facebook}" target="_blank"><i class="fab fa-facebook"></i></a>` : ''}
                        ${social.instagram ? `<a href="${social.instagram}" target="_blank"><i class="fab fa-instagram"></i></a>` : ''}
                        ${social.twitter ? `<a href="${social.twitter}" target="_blank"><i class="fab fa-twitter"></i></a>` : ''}
                        ${social.youtube ? `<a href="${social.youtube}" target="_blank"><i class="fab fa-youtube"></i></a>` : ''}
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Kontak</h3>
                    <p><i class="fas fa-phone"></i> WhatsApp: ${state.siteData.admin.whatsapp_number}</p>
                    <p><i class="fas fa-envelope"></i> Email: ${state.siteData.admin.email}</p>
                    <p><i class="fas fa-user"></i> Admin: ${state.siteData.admin.admin_name}</p>
                </div>
                
                <div class="footer-section">
                    <h3>Jam Operasional</h3>
                    ${openHours.weekdays ? `<p>Weekdays: ${openHours.weekdays}</p>` : ''}
                    ${openHours.weekends ? `<p>Weekends: ${openHours.weekends}</p>` : ''}
                    ${openHours.holiday ? `<p>Holiday: ${openHours.holiday}</p>` : ''}
                </div>
            `;
            
            footerContent.innerHTML = html;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Cart icon click
            cartIcon.addEventListener('click', () => {
                openCartModal();
            });
            
            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', () => {
                mainNav.classList.toggle('active');
            });
            
            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
                const waModal = document.getElementById('waModal');
                const cartModal = document.getElementById('cartModal');
                
                if (e.target === waModal) {
                    waModal.classList.add('hidden');
                }
                
                if (e.target === cartModal) {
                    cartModal.classList.add('hidden');
                }
            });
            
            // Save admin override
            saveOverrideBtn.addEventListener('click', () => {
                const number = overrideWhatsapp.value.trim();
                if (number) {
                    state.adminOverride.whatsapp_number = number;
                } else {
                    delete state.adminOverride.whatsapp_number;
                }
                
                localStorage.setItem('adit_config_override', JSON.stringify(state.adminOverride));
                alert('Pengaturan disimpan!');
            });
            
            // Hash change for navigation
            window.addEventListener('hashchange', () => {
                renderPage();
            });
        }

        // Setup navigation
        function setupNavigation() {
            // Handle nav link clicks
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const hash = link.getAttribute('href');
                    window.location.hash = hash;
                    
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                    link.classList.add('active');
                    
                    // Close mobile menu if open
                    if (window.innerWidth <= 768) {
                        mainNav.classList.remove('active');
                    }
                });
            });
        }

        // Render page based on hash
        function renderPage() {
            const hash = window.location.hash.substring(1) || 'home';
            state.currentPage = hash;
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${hash}`) {
                    link.classList.add('active');
                }
            });
            
            // Render page content
            switch(hash) {
                case 'home':
                    renderHomePage();
                    break;
                case 'products':
                    renderProductsPage();
                    break;
                case 'product-detail':
                    renderProductDetailPage();
                    break;
                case 'checkout':
                    renderCheckoutPage();
                    break;
                case 'promo':
                    renderPromoPage();
                    break;
                case 'membership':
                    renderMembershipPage();
                    break;
                case 'support':
                    renderSupportPage();
                    break;
                case 'history':
                    renderHistoryPage();
                    break;
                default:
                    renderHomePage();
            }
        }

        // Render home page
        function renderHomePage() {
            if (!state.siteData) return;
            
            const products = state.siteData.products || [];
            const promos = state.siteData.promos || [];
            const featuredProducts = products.filter(p => p.recommend).slice(0, 4);
            
            let html = `
                <div class="hero">
                    <h1>${state.siteData.site.name}</h1>
                    <p>${state.siteData.site.description}</p>
                    <a href="#products" class="btn btn-success">
                        <i class="fas fa-shopping-bag"></i> Beli Sekarang
                    </a>
                </div>
                
                <section id="featured-products">
                    <h2 class="section-title">Produk Unggulan</h2>
                    <div class="products-grid">
            `;
            
            featuredProducts.forEach(product => {
                const lowestPrice = product.items.reduce((min, item) => 
                    item.price < min ? item.price : min, product.items[0].price);
                
                html += `
                    <div class="product-card" data-id="${product.id}">
                        <div class="product-image">
                            <img src="${product.images[0] || 'https://picsum.photos/seed/' + product.id + '/400/300'}" alt="${product.name}">
                        </div>
                        <div class="product-content">
                            <div class="product-badges">
                                ${product.recommend ? '<span class="badge recommend">Rekomendasi</span>' : ''}
                                ${product.badges && product.badges.includes('hot') ? '<span class="badge hot">Hot</span>' : ''}
                            </div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-publisher">${product.publisher}</p>
                            <p class="product-price">${formatCurrency(lowestPrice)}</p>
                            <button class="btn btn-block add-to-cart-btn" data-product-id="${product.id}">
                                <i class="fas fa-cart-plus"></i> Tambah ke Keranjang
                            </button>
                            <a href="#product-detail?id=${product.id}" class="btn btn-secondary btn-block mt-1">
                                <i class="fas fa-info-circle"></i> Detail
                            </a>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </section>
                
                <section id="promotions" class="mt-5">
                    <h2 class="section-title">Promo & Diskon</h2>
                    <div class="products-grid">
            `;
            
            promos.forEach((promo, index) => {
                html += `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${promo.image || 'https://picsum.photos/seed/promo' + index + '/400/300'}" alt="${promo.title}">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">${promo.title}</h3>
                            <p>${promo.description}</p>
                            <p><strong>Berlaku hingga:</strong> ${promo.valid_until || '30 Desember 2023'}</p>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </section>
                
                <section id="usp" class="mt-5">
                    <h2 class="section-title">Mengapa Beli di ${state.siteData.site.shortName}?</h2>
                    <div class="products-grid">
                        <div class="product-card text-center">
                            <div class="product-content">
                                <i class="fas fa-bolt fa-3x" style="color: var(--accent); margin-bottom: 1rem;"></i>
                                <h3>Proses Cepat</h3>
                                <p>Voucher dikirim dalam waktu kurang dari 3 menit setelah pembayaran dikonfirmasi</p>
                            </div>
                        </div>
                        <div class="product-card text-center">
                            <div class="product-content">
                                <i class="fas fa-shield-alt fa-3x" style="color: var(--accent); margin-bottom: 1rem;"></i>
                                <h3>Aman & Terpercaya</h3>
                                <p>Transaksi aman dengan sistem pembayaran terenkripsi</p>
                            </div>
                        </div>
                        <div class="product-card text-center">
                            <div class="product-content">
                                <i class="fas fa-headset fa-3x" style="color: var(--accent); margin-bottom: 1rem;"></i>
                                <h3>Support 24/7</h3>
                                <p>Customer service siap membantu kapan saja</p>
                            </div>
                        </div>
                    </div>
                </section>
            `;
            
            appContent.innerHTML = html;
            
            // Add event listeners to buttons
            setTimeout(() => {
                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = e.target.closest('.add-to-cart-btn').dataset.productId;
                        addToCart(productId);
                    });
                });
                
                document.querySelectorAll('.product-card[data-id]').forEach(card => {
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('.add-to-cart-btn') && !e.target.closest('a')) {
                            const productId = card.dataset.id;
                            window.location.hash = `product-detail?id=${productId}`;
                        }
                    });
                });
            }, 100);
        }

        // Render products page
        function renderProductsPage() {
            if (!state.siteData) return;
            
            const products = state.siteData.products || [];
            const categories = [...new Set(products.map(p => p.category))];
            
            let html = `
                <h1 class="section-title">Semua Produk</h1>
                
                <div class="search-filter">
                    <div class="search-box">
                        <input type="text" id="searchInput" class="form-control" placeholder="Cari produk...">
                    </div>
                    <div class="filter-category">
                        <select id="categoryFilter" class="form-control">
                            <option value="">Semua Kategori</option>
                            ${categories.map(cat => `<option value="${cat}">${cat}</option>`).join('')}
                        </select>
                    </div>
                </div>
                
                <div class="products-grid" id="productsContainer">
            `;
            
            products.forEach(product => {
                const lowestPrice = product.items.reduce((min, item) => 
                    item.price < min ? item.price : min, product.items[0].price);
                
                html += `
                    <div class="product-card" data-id="${product.id}" data-category="${product.category}">
                        <div class="product-image">
                            <img src="${product.images[0] || 'https://picsum.photos/seed/' + product.id + '/400/300'}" alt="${product.name}">
                        </div>
                        <div class="product-content">
                            <div class="product-badges">
                                ${product.recommend ? '<span class="badge recommend">Rekomendasi</span>' : ''}
                                ${product.badges && product.badges.includes('hot') ? '<span class="badge hot">Hot</span>' : ''}
                            </div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-publisher">${product.publisher}</p>
                            <p class="product-price">Mulai dari ${formatCurrency(lowestPrice)}</p>
                            <button class="btn btn-block add-to-cart-btn" data-product-id="${product.id}">
                                <i class="fas fa-cart-plus"></i> Tambah ke Keranjang
                            </button>
                            <a href="#product-detail?id=${product.id}" class="btn btn-secondary btn-block mt-1">
                                <i class="fas fa-info-circle"></i> Detail
                            </a>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            appContent.innerHTML = html;
            
            // Add event listeners
            setTimeout(() => {
                // Add to cart buttons
                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = e.target.closest('.add-to-cart-btn').dataset.productId;
                        addToCart(productId);
                    });
                });
                
                // Product card click
                document.querySelectorAll('.product-card[data-id]').forEach(card => {
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('.add-to-cart-btn') && !e.target.closest('a')) {
                            const productId = card.dataset.id;
                            window.location.hash = `product-detail?id=${productId}`;
                        }
                    });
                });
                
                // Search functionality
                const searchInput = document.getElementById('searchInput');
                const categoryFilter = document.getElementById('categoryFilter');
                const productsContainer = document.getElementById('productsContainer');
                const productCards = Array.from(document.querySelectorAll('.product-card[data-id]'));
                
                function filterProducts() {
                    const searchTerm = searchInput.value.toLowerCase();
                    const selectedCategory = categoryFilter.value;
                    
                    productCards.forEach(card => {
                        const productName = card.querySelector('.product-name').textContent.toLowerCase();
                        const productCategory = card.dataset.category;
                        const matchesSearch = productName.includes(searchTerm);
                        const matchesCategory = !selectedCategory || productCategory === selectedCategory;
                        
                        card.style.display = (matchesSearch && matchesCategory) ? 'block' : 'none';
                    });
                }
                
                // Debounce search
                let searchTimeout;
                searchInput.addEventListener('input', () => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(filterProducts, 300);
                });
                
                categoryFilter.addEventListener('change', filterProducts);
            }, 100);
        }

        // Render product detail page
        function renderProductDetailPage() {
            if (!state.siteData) return;
            
            const urlParams = new URLSearchParams(window.location.hash.split('?')[1]);
            const productId = urlParams.get('id');
            
            if (!productId) {
                window.location.hash = 'products';
                return;
            }
            
            const product = state.siteData.products.find(p => p.id === productId);
            
            if (!product) {
                appContent.innerHTML = '<div class="error">Produk tidak ditemukan</div>';
                return;
            }
            
            let html = `
                <a href="#products" class="btn btn-secondary mb-3">
                    <i class="fas fa-arrow-left"></i> Kembali
                </a>
                
                <div class="product-detail">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
                        <div>
                            <div class="product-image" style="height: 300px;">
                                <img src="${product.images[0] || 'https://picsum.photos/seed/' + product.id + '/600/400'}" alt="${product.name}" style="object-fit: contain;">
                            </div>
                            <div class="product-badges mt-2">
                                ${product.recommend ? '<span class="badge recommend">Rekomendasi</span>' : ''}
                                ${product.badges && product.badges.includes('hot') ? '<span class="badge hot">Hot</span>' : ''}
                                <span class="badge">${product.category}</span>
                            </div>
                        </div>
                        
                        <div>
                            <h1 class="product-name">${product.name}</h1>
                            <p class="product-publisher">Publisher: ${product.publisher}</p>
                            <p>${product.description}</p>
                            
                            <h3 class="mt-4 mb-2">Pilih Denominasi:</h3>
                            <div id="denomList">
            `;
            
            product.items.forEach(item => {
                html += `
                    <div class="product-card" style="margin-bottom: 1rem;">
                        <div class="product-content">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h4>${item.denom}</h4>
                                    <p class="product-price">${formatCurrency(item.price)}</p>
                                </div>
                                <button class="btn add-to-cart-denom-btn" data-product-id="${product.id}" data-sku="${item.sku}" data-price="${item.price}" data-denom="${item.denom}">
                                    <i class="fas fa-cart-plus"></i> Tambah
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            appContent.innerHTML = html;
            
            // Add event listeners
            setTimeout(() => {
                document.querySelectorAll('.add-to-cart-denom-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = btn.dataset.productId;
                        const sku = btn.dataset.sku;
                        const price = parseFloat(btn.dataset.price);
                        const denom = btn.dataset.denom;
                        
                        addToCart(productId, sku, denom, price);
                    });
                });
            }, 100);
        }

        // Render checkout page
        function renderCheckoutPage() {
            if (!state.siteData) return;
            
            if (state.cart.length === 0) {
                appContent.innerHTML = `
                    <div class="text-center">
                        <h2>Keranjang belanja kosong</h2>
                        <p class="my-3">Tambahkan produk ke keranjang terlebih dahulu</p>
                        <a href="#products" class="btn btn-success">Lihat Produk</a>
                    </div>
                `;
                return;
            }
            
            // Calculate totals
            let subtotal = 0;
            state.cart.forEach(item => {
                subtotal += item.price * item.quantity;
            });
            
            const paymentMethods = state.siteData.payment_methods.filter(p => p.enabled);
            
            let html = `
                <h1 class="section-title">Checkout</h1>
                
                <div class="checkout-container">
                    <div class="checkout-form">
                        <h3>Detail Pesanan</h3>
                        
                        <div class="cart-items">
            `;
            
            state.cart.forEach((item, index) => {
                html += `
                    <div class="cart-item">
                        <div>
                            <h4>${item.productName} - ${item.denom}</h4>
                            <p>${formatCurrency(item.price)} × ${item.quantity}</p>
                        </div>
                        <div>
                            <button class="btn btn-secondary remove-item-btn" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                        
                        <div class="form-group">
                            <label for="username">Username / ID Game *</label>
                            <input type="text" id="username" class="form-control" required placeholder="Masukkan username atau ID game Anda">
                        </div>
                        
                        <div class="form-group">
                            <label for="phone">Nomor WhatsApp *</label>
                            <input type="tel" id="phone" class="form-control" required placeholder="628xxxxxxx">
                        </div>
                        
                        <div class="form-group">
                            <label for="notes">Catatan (opsional)</label>
                            <textarea id="notes" class="form-control" rows="3" placeholder="Catatan tambahan untuk admin"></textarea>
                        </div>
                    </div>
                    
                    <div class="order-summary">
                        <h3>Ringkasan Pembayaran</h3>
                        
                        <div class="cart-items">
                            <div class="cart-item">
                                <span>Subtotal</span>
                                <span>${formatCurrency(subtotal)}</span>
                            </div>
                            <div class="cart-item">
                                <span>Diskon</span>
                                <span>${formatCurrency(0)}</span>
                            </div>
                            <div class="cart-item">
                                <span>Biaya Layanan</span>
                                <span id="paymentFee">${formatCurrency(0)}</span>
                            </div>
                            <div class="cart-item" style="font-weight: bold; font-size: 1.2rem;">
                                <span>Total</span>
                                <span id="totalAmount">${formatCurrency(subtotal)}</span>
                            </div>
                        </div>
                        
                        <h3 class="mt-4">Metode Pembayaran</h3>
                        
                        <div class="payment-methods" id="paymentMethods">
            `;
            
            paymentMethods.forEach(method => {
                html += `
                    <div class="payment-method" data-method-id="${method.id}">
                        <input type="radio" name="payment" id="payment_${method.id}" value="${method.id}">
                        <img src="${method.image || 'https://picsum.photos/seed/' + method.id + '/100/100'}" alt="${method.name}" class="payment-logo">
                        <div class="payment-details">
                            <div class="payment-name">${method.name}</div>
                            <div class="payment-fee">Biaya: ${formatCurrency(method.fee || 0)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                        
                        <div id="paymentInstructions" class="payment-instructions hidden">
                            <h4>Instruksi Pembayaran</h4>
                            <ol id="instructionsList"></ol>
                            <div id="qrContainer" class="qr-container hidden">
                                <img id="qrImage" src="" alt="QR Code">
                                <button class="btn btn-secondary" id="downloadQrBtn">
                                    <i class="fas fa-download"></i> Download QR
                                </button>
                            </div>
                            <div id="accountInfo" class="hidden mt-3">
                                <p><strong>Nomor Rekening:</strong> <span id="accountNumber"></span></p>
                                <button class="btn btn-secondary" id="copyAccountBtn">
                                    <i class="far fa-copy"></i> Salin Nomor
                                </button>
                            </div>
                        </div>
                        
                        <button class="btn btn-success btn-block mt-4" id="sendToWhatsAppBtn">
                            <i class="fab fa-whatsapp"></i> Kirim Pesanan ke WhatsApp
                        </button>
                    </div>
                </div>
            `;
            
            appContent.innerHTML = html;
            
            // Add event listeners
            setTimeout(() => {
                // Remove item buttons
                document.querySelectorAll('.remove-item-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.closest('.remove-item-btn').dataset.index);
                        removeFromCart(index);
                    });
                });
                
                // Payment method selection
                document.querySelectorAll('.payment-method').forEach(method => {
                    method.addEventListener('click', (e) => {
                        const methodId = method.dataset.methodId;
                        selectPaymentMethod(methodId);
                    });
                });
                
                // Send to WhatsApp button
                document.getElementById('sendToWhatsAppBtn').addEventListener('click', processCheckout);
                
                // Download QR button
                document.getElementById('downloadQrBtn')?.addEventListener('click', downloadQR);
                
                // Copy account button
                document.getElementById('copyAccountBtn')?.addEventListener('click', copyAccountNumber);
            }, 100);
        }

        // Select payment method
        function selectPaymentMethod(methodId) {
            state.selectedPayment = methodId;
            
            // Update UI
            document.querySelectorAll('.payment-method').forEach(m => {
                m.classList.remove('selected');
                const radio = m.querySelector('input[type="radio"]');
                if (radio.value === methodId) {
                    m.classList.add('selected');
                    radio.checked = true;
                }
            });
            
            // Show payment instructions
            const paymentMethod = state.siteData.payment_methods.find(p => p.id === methodId);
            if (!paymentMethod) return;
            
            const instructionsDiv = document.getElementById('paymentInstructions');
            const instructionsList = document.getElementById('instructionsList');
            const qrContainer = document.getElementById('qrContainer');
            const accountInfo = document.getElementById('accountInfo');
            
            instructionsDiv.classList.remove('hidden');
            
            // Update instructions
            if (paymentMethod.instructions && paymentMethod.instructions.length > 0) {
                instructionsList.innerHTML = paymentMethod.instructions.map(inst => `<li>${inst}</li>`).join('');
            } else {
                instructionsList.innerHTML = '<li>Ikuti instruksi pada aplikasi pembayaran Anda</li>';
            }
            
            // Show QR if available
            if (paymentMethod.qr_image) {
                qrContainer.classList.remove('hidden');
                document.getElementById('qrImage').src = paymentMethod.qr_image;
            } else {
                qrContainer.classList.add('hidden');
            }
            
            // Show account info if available
            if (paymentMethod.account_info) {
                accountInfo.classList.remove('hidden');
                document.getElementById('accountNumber').textContent = paymentMethod.account_info.account_number || '';
            } else {
                accountInfo.classList.add('hidden');
            }
            
            // Update fee and total
            const subtotal = state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const fee = paymentMethod.fee || 0;
            const total = subtotal + fee;
            
            document.getElementById('paymentFee').textContent = formatCurrency(fee);
            document.getElementById('totalAmount').textContent = formatCurrency(total);
        }

        // Process checkout
        function processCheckout() {
            // Validate form
            const username = document.getElementById('username')?.value.trim();
            const phone = document.getElementById('phone')?.value.trim();
            
            if (!username) {
                alert('Harap masukkan username / ID game');
                return;
            }
            
            if (!phone) {
                alert('Harap masukkan nomor WhatsApp');
                return;
            }
            
            if (!state.selectedPayment) {
                alert('Harap pilih metode pembayaran');
                return;
            }
            
            // Generate order ID
            const orderId = 'ORD' + Date.now() + Math.floor(Math.random() * 1000);
            
            // Calculate totals
            const subtotal = state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const paymentMethod = state.siteData.payment_methods.find(p => p.id === state.selectedPayment);
            const fee = paymentMethod?.fee || 0;
            const total = subtotal + fee;
            
            // Create order object
            const order = {
                order_id: orderId,
                items: [...state.cart],
                subtotal,
                fee,
                total,
                username,
                phone,
                payment_method: state.selectedPayment,
                status: 'pending_manual',
                created_at: new Date().toISOString(),
                notes: document.getElementById('notes')?.value.trim() || ''
            };
            
            // Save to localStorage
            state.orders.unshift(order);
            localStorage.setItem('adit_orders', JSON.stringify(state.orders));
            
            // Clear cart
            state.cart = [];
            localStorage.setItem('adit_cart', JSON.stringify(state.cart));
            updateCartCount();
            
            // Prepare WhatsApp message
            const whatsappNumber = state.adminOverride.whatsapp_number || state.siteData.admin.whatsapp_number;
            const message = generateWhatsAppMessage(order, paymentMethod);
            const encodedMessage = encodeURIComponent(message);
            
            // Save message for later use
            state.lastOrder = { orderId, total, message, whatsappNumber };
            
            // Show success modal
            showWhatsAppModal(orderId, total);
        }

        // Generate WhatsApp message from template
        function generateWhatsAppMessage(order, paymentMethod) {
            let template = state.siteData.whatsapp_message_template;
            
            // Replace placeholders
            const replacements = {
                '{{admin_name}}': state.siteData.admin.admin_name,
                '{{order_id}}': order.order_id,
                '{{product_name}}': order.items.map(item => `${item.productName} - ${item.denom}`).join(', '),
                '{{denom}}': order.items.map(item => item.denom).join(', '),
                '{{price}}': order.items.map(item => formatCurrency(item.price)).join(', '),
                '{{quantity}}': order.items.map(item => item.quantity).join(', '),
                '{{total}}': formatCurrency(order.total),
                '{{username}}': order.username,
                '{{phone}}': order.phone,
                '{{payment_method}}': paymentMethod?.name || '',
                '{{payment_instructions}}': paymentMethod?.instructions?.join('\n') || ''
            };
            
            Object.keys(replacements).forEach(key => {
                template = template.replace(new RegExp(key, 'g'), replacements[key]);
            });
            
            return template;
        }

        // Show WhatsApp modal
        function showWhatsAppModal(orderId, total) {
            const modal = document.getElementById('waModal');
            const orderIdSpan = document.getElementById('modalOrderId');
            const orderTotalSpan = document.getElementById('modalOrderTotal');
            const openWhatsAppBtn = document.getElementById('openWhatsAppBtn');
            const copyMessageBtn = document.getElementById('copyMessageBtn');
            const closeModal = document.getElementById('closeWaModal');
            
            orderIdSpan.textContent = orderId;
            orderTotalSpan.textContent = formatCurrency(total);
            
            modal.classList.remove('hidden');
            
            // Setup button events
            openWhatsAppBtn.onclick = () => {
                const { message, whatsappNumber } = state.lastOrder;
                const encodedMessage = encodeURIComponent(message);
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                
                let url;
                if (isMobile) {
                    url = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
                } else {
                    url = `https://web.whatsapp.com/send?phone=${whatsappNumber}&text=${encodedMessage}`;
                }
                
                window.open(url, '_blank');
            };
            
            copyMessageBtn.onclick = () => {
                const { message } = state.lastOrder;
                navigator.clipboard.writeText(message).then(() => {
                    alert('Pesan berhasil disalin ke clipboard!');
                });
            };
            
            closeModal.onclick = () => {
                modal.classList.add('hidden');
                window.location.hash = 'history';
            };
        }

        // Render promo page
        function renderPromoPage() {
            if (!state.siteData) return;
            
            const promos = state.siteData.promos || [];
            const articles = state.siteData.articles || [];
            
            let html = `
                <h1 class="section-title">Promo & Artikel</h1>
                
                <h2 class="mt-4 mb-3">Promo Aktif</h2>
                <div class="products-grid">
            `;
            
            promos.forEach((promo, index) => {
                html += `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${promo.image || 'https://picsum.photos/seed/promo' + index + '/400/300'}" alt="${promo.title}">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">${promo.title}</h3>
                            <p>${promo.description}</p>
                            <p><strong>Kode:</strong> <span style="color: var(--accent);">${promo.code || 'TANPAKODE'}</span></p>
                            <p><strong>Berlaku hingga:</strong> ${promo.valid_until || '30 Desember 2023'}</p>
                        </div>
                    </div>
                `;
            });
            
            html += `
                </div>
                
                <h2 class="mt-5 mb-3">Artikel & Berita</h2>
                <div class="products-grid">
            `;
            
            articles.forEach((article, index) => {
                html += `
                    <div class="product-card">
                        <div class="product-image">
                            <img src="${article.image || 'https://picsum.photos/seed/article' + index + '/400/300'}" alt="${article.title}">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">${article.title}</h3>
                            <p>${article.excerpt || article.content.substring(0, 150) + '...'}</p>
                            <p><small>${article.date || '1 Januari 2023'}</small></p>
                            <button class="btn btn-block mt-2 read-article-btn" data-index="${index}">
                                <i class="fas fa-book-open"></i> Baca Artikel
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            appContent.innerHTML = html;
            
            // Add event listeners for article buttons
            setTimeout(() => {
                document.querySelectorAll('.read-article-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.closest('.read-article-btn').dataset.index);
                        const article = articles[index];
                        
                        // Show article in modal
                        const modal = document.getElementById('waModal');
                        const modalBody = modal.querySelector('.modal-body');
                        
                        modalBody.innerHTML = `
                            <h3>${article.title}</h3>
                            <p><small>${article.date || '1 Januari 2023'}</small></p>
                            <div class="product-image my-3">
                                <img src="${article.image || 'https://picsum.photos/seed/article' + index + '/800/450'}" alt="${article.title}">
                            </div>
                            <p>${article.content || article.excerpt}</p>
                        `;
                        
                        modal.classList.remove('hidden');
                        
                        // Update modal title and buttons
                        modal.querySelector('h3').textContent = article.title;
                        modal.querySelector('.modal-footer').innerHTML = `
                            <button class="btn btn-secondary" id="closeArticleBtn">Tutup</button>
                        `;
                        
                        document.getElementById('closeArticleBtn').addEventListener('click', () => {
                            modal.classList.add('hidden');
                        });
                    });
                });
            }, 100);
        }

        // Render membership page
        function renderMembershipPage() {
            let html = `
                <h1 class="section-title">Membership</h1>
                
                <div class="hero" style="background: linear-gradient(135deg, var(--success) 0%, var(--accent) 100%);">
                    <h2>Level Up Pengalaman Belanja Anda!</h2>
                    <p>Dapatkan keuntungan eksklusif dengan menjadi member premium</p>
                </div>
                
                <div class="products-grid mt-5">
                    <div class="product-card text-center">
                        <div class="product-content">
                            <h3><i class="fas fa-crown" style="color: gold;"></i> Member Bronze</h3>
                            <p class="product-price">GRATIS</p>
                            <ul style="text-align: left; margin: 1.5rem 0;">
                                <li>Cashback 2% setiap transaksi</li>
                                <li>Notifikasi promo terbaru</li>
                                <li>Support prioritas</li>
                            </ul>
                            <button class="btn btn-block">Daftar Sekarang</button>
                        </div>
                    </div>
                    
                    <div class="product-card text-center">
                        <div class="product-content">
                            <h3><i class="fas fa-crown" style="color: silver;"></i> Member Silver</h3>
                            <p class="product-price">Rp 50.000/bln</p>
                            <ul style="text-align: left; margin: 1.5rem 0;">
                                <li>Cashback 5% setiap transaksi</li>
                                <li>Bonus voucher bulanan</li>
                                <li>Free biaya admin</li>
                                <li>Support 24/7</li>
                            </ul>
                            <button class="btn btn-block btn-success">Upgrade Sekarang</button>
                        </div>
                    </div>
                    
                    <div class="product-card text-center">
                        <div class="product-content">
                            <h3><i class="fas fa-crown" style="color: #ffd700;"></i> Member Gold</h3>
                            <p class="product-price">Rp 100.000/bln</p>
                            <ul style="text-align: left; margin: 1.5rem 0;">
                                <li>Cashback 10% setiap transaksi</li>
                                <li>Bonus voucher mingguan</li>
                                <li>Free biaya admin + potongan harga</li>
                                <li>Personal account manager</li>
                                <li>Akses promo eksklusif</li>
                            </ul>
                            <button class="btn btn-block btn-success">Upgrade Sekarang</button>
                        </div>
                    </div>
                </div>
                
                <div class="product-card mt-5">
                    <div class="product-content">
                        <h3>Keuntungan Membership</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                            <div>
                                <h4><i class="fas fa-percentage"></i> Cashback</h4>
                                <p>Dapatkan cashback hingga 10% untuk setiap transaksi</p>
                            </div>
                            <div>
                                <h4><i class="fas fa-gift"></i> Bonus Voucher</h4>
                                <p>Voucher gratis setiap minggu/bulan sesuai level membership</p>
                            </div>
                            <div>
                                <h4><i class="fas fa-headset"></i> Priority Support</h4>
                                <p>Layanan support prioritas 24/7</p>
                            </div>
                            <div>
                                <h4><i class="fas fa-bolt"></i> Proses Cepat</h4>
                                <p>Proses transaksi lebih cepat untuk member</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            appContent.innerHTML = html;
        }

        // Render support page
        function renderSupportPage() {
            let html = `
                <h1 class="section-title">Pusat Bantuan</h1>
                
                <div class="hero" style="background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);">
                    <h2>Butuh Bantuan?</h2>
                    <p>Kami siap membantu Anda 24 jam sehari, 7 hari seminggu</p>
                </div>
                
                <div class="products-grid mt-5">
                    <div class="product-card text-center">
                        <div class="product-content">
                            <i class="fas fa-question-circle fa-3x" style="color: var(--accent); margin-bottom: 1rem;"></i>
                            <h3>FAQ</h3>
                            <p>Temukan jawaban dari pertanyaan yang sering diajukan</p>
                            <button class="btn btn-block mt-3" id="showFaqBtn">Lihat FAQ</button>
                        </div>
                    </div>
                    
                    <div class="product-card text-center">
                        <div class="product-content">
                            <i class="fab fa-whatsapp fa-3x" style="color: #25D366; margin-bottom: 1rem;"></i>
                            <h3>WhatsApp Support</h3>
                            <p>Hubungi kami via WhatsApp untuk bantuan cepat</p>
                            <button class="btn btn-success btn-block mt-3" id="contactWhatsAppBtn">
                                <i class="fab fa-whatsapp"></i> Hubungi Sekarang
                            </button>
                        </div>
                    </div>
                    
                    <div class="product-card text-center">
                        <div class="product-content">
                            <i class="fas fa-envelope fa-3x" style="color: var(--accent); margin-bottom: 1rem;"></i>
                            <h3>Email Support</h3>
                            <p>Kirim email kepada kami untuk pertanyaan detail</p>
                            <button class="btn btn-block mt-3" id="contactEmailBtn">Kirim Email</button>
                        </div>
                    </div>
                </div>
                
                <div class="product-card mt-5">
                    <div class="product-content">
                        <h3>Pertanyaan Umum (FAQ)</h3>
                        <div id="faqList" style="margin-top: 1.5rem;">
                            <div class="faq-item" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                                <h4>Bagaimana cara melakukan pembelian?</h4>
                                <p>Pilih produk, tambahkan ke keranjang, lalu checkout. Setelah itu, kirim pesan ke WhatsApp admin untuk konfirmasi pembayaran.</p>
                            </div>
                            <div class="faq-item" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                                <h4>Berapa lama voucher dikirim?</h4>
                                <p>Voucher dikirim dalam waktu 1-5 menit setelah pembayaran dikonfirmasi oleh admin.</p>
                            </div>
                            <div class="faq-item" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                                <h4>Metode pembayaran apa saja yang tersedia?</h4>
                                <p>Kami mendukung QRIS, transfer bank (BCA, BRI, BNI, Mandiri), e-wallet (Dana, OVO, Gopay), dan pembayaran di retail (Indomaret, Alfamart).</p>
                            </div>
                            <div class="faq-item" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                                <h4>Bagaimana jika voucher tidak terkirim?</h4>
                                <p>Segera hubungi admin via WhatsApp dengan menyertakan ID pesanan dan bukti pembayaran.</p>
                            </div>
                            <div class="faq-item">
                                <h4>Apakah ada garansi untuk pembelian?</h4>
                                <p>Ya, semua pembelian dijamin 100% aman. Jika ada masalah, kami akan mengganti atau mengembalikan dana.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            appContent.innerHTML = html;
            
            // Add event listeners
            setTimeout(() => {
                document.getElementById('contactWhatsAppBtn').addEventListener('click', () => {
                    const whatsappNumber = state.adminOverride.whatsapp_number || state.siteData?.admin?.whatsapp_number || '6285311111010';
                    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                    
                    let url;
                    if (isMobile) {
                        url = `https://wa.me/${whatsappNumber}`;
                    } else {
                        url = `https://web.whatsapp.com/send?phone=${whatsappNumber}`;
                    }
                    
                    window.open(url, '_blank');
                });
                
                document.getElementById('contactEmailBtn').addEventListener('click', () => {
                    const email = state.siteData?.admin?.email || 'admin@gamestore.id';
                    window.location.href = `mailto:${email}`;
                });
            }, 100);
        }

        // Render order history page
        function renderHistoryPage() {
            let html = `
                <h1 class="section-title">Riwayat Pesanan</h1>
                
                <div class="orders-list" id="ordersList">
            `;
            
            if (state.orders.length === 0) {
                html += `
                    <div class="text-center">
                        <p>Belum ada pesanan</p>
                        <a href="#products" class="btn btn-success mt-2">Mulai Belanja</a>
                    </div>
                `;
            } else {
                state.orders.forEach(order => {
                    const date = new Date(order.created_at).toLocaleDateString('id-ID', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    html += `
                        <div class="order-card">
                            <div class="order-header">
                                <div>
                                    <span class="order-id">${order.order_id}</span>
                                    <span class="order-status status-${order.status === 'pending_manual' ? 'pending' : 'completed'}">
                                        ${order.status === 'pending_manual' ? 'Menunggu Pembayaran' : 'Selesai'}
                                    </span>
                                </div>
                                <div>${date}</div>
                            </div>
                            <div>
                                <p><strong>Produk:</strong> ${order.items.map(item => `${item.productName} - ${item.denom} (${item.quantity}x)`).join(', ')}</p>
                                <p><strong>Username:</strong> ${order.username}</p>
                                <p><strong>Metode Pembayaran:</strong> ${order.payment_method}</p>
                                <p><strong>Total:</strong> ${formatCurrency(order.total)}</p>
                            </div>
                        </div>
                    `;
                });
            }
            
            html += `</div>`;
            
            appContent.innerHTML = html;
        }

        // Cart functions
        function addToCart(productId, sku = null, denom = null, price = null) {
            if (!state.siteData) return;
            
            const product = state.siteData.products.find(p => p.id === productId);
            if (!product) return;
            
            // If specific denom is not provided, use the first one
            if (!sku || !denom || !price) {
                const firstItem = product.items[0];
                sku = firstItem.sku;
                denom = firstItem.denom;
                price = firstItem.price;
            }
            
            // Check if item already in cart
            const existingItem = state.cart.find(item => 
                item.productId === productId && item.sku === sku
            );
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                state.cart.push({
                    productId,
                    productName: product.name,
                    sku,
                    denom,
                    price,
                    quantity: 1
                });
            }
            
            // Save to localStorage
            localStorage.setItem('adit_cart', JSON.stringify(state.cart));
            
            // Update UI
            updateCartCount();
            
            // Show notification
            showNotification(`${product.name} - ${denom} ditambahkan ke keranjang`);
            
            // Update cart modal if open
            if (!document.getElementById('cartModal').classList.contains('hidden')) {
                updateCartModal();
            }
        }

        function removeFromCart(index) {
            state.cart.splice(index, 1);
            localStorage.setItem('adit_cart', JSON.stringify(state.cart));
            updateCartCount();
            
            // Refresh current page if it's checkout page
            if (state.currentPage === 'checkout') {
                renderCheckoutPage();
            } else {
                updateCartModal();
            }
        }

        function updateCartCount() {
            const count = state.cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = count;
        }

        function openCartModal() {
            const modal = document.getElementById('cartModal');
            modal.classList.remove('hidden');
            updateCartModal();
        }

        function updateCartModal() {
            const container = document.getElementById('cartItemsContainer');
            const emptyMessage = document.getElementById('emptyCartMessage');
            const checkoutBtn = document.getElementById('checkoutBtn');
            const continueBtn = document.getElementById('continueShoppingBtn');
            const closeBtn = document.getElementById('closeCartModal');
            
            if (state.cart.length === 0) {
                container.innerHTML = '';
                emptyMessage.classList.remove('hidden');
                checkoutBtn.classList.add('hidden');
            } else {
                emptyMessage.classList.add('hidden');
                checkoutBtn.classList.remove('hidden');
                
                let html = '';
                let subtotal = 0;
                
                state.cart.forEach((item, index) => {
                    subtotal += item.price * item.quantity;
                    
                    html += `
                        <div class="cart-item">
                            <div>
                                <h4>${item.productName} - ${item.denom}</h4>
                                <p>${formatCurrency(item.price)} × ${item.quantity}</p>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <span>${formatCurrency(item.price * item.quantity)}</span>
                                <button class="btn btn-secondary remove-item-btn" data-index="${index}" style="padding: 0.5rem;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                    <div class="cart-item" style="font-weight: bold; border-top: 2px solid var(--border); margin-top: 1rem; padding-top: 1rem;">
                        <span>Total</span>
                        <span>${formatCurrency(subtotal)}</span>
                    </div>
                `;
                
                container.innerHTML = html;
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-item-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.closest('.remove-item-btn').dataset.index);
                        removeFromCart(index);
                    });
                });
            }
            
            // Set up button events
            checkoutBtn.onclick = () => {
                modal.classList.add('hidden');
                window.location.hash = 'checkout';
            };
            
            continueBtn.onclick = () => {
                modal.classList.add('hidden');
                window.location.hash = 'products';
            };
            
            closeBtn.onclick = () => {
                modal.classList.add('hidden');
            };
        }

        // Utility functions
        function formatCurrency(amount) {
            if (!state.siteData) return `Rp ${amount.toLocaleString('id-ID')}`;
            
            const currency = state.siteData.site.currency || 'IDR';
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 0
            }).format(amount);
        }

        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div style="position: fixed; top: 100px; right: 20px; background: var(--success); color: white; padding: 1rem; border-radius: var(--radius); z-index: 1000; box-shadow: var(--shadow);">
                    <i class="fas fa-check-circle"></i> ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showError(message) {
            appContent.innerHTML = `
                <div class="error">
                    <h3>Terjadi Kesalahan</h3>
                    <p>${message}</p>
                    <button class="btn btn-secondary mt-2" id="retryBtn">Coba Lagi</button>
                </div>
            `;
            
            document.getElementById('retryBtn').addEventListener('click', () => {
                location.reload();
            });
        }

        function downloadQR() {
            const qrImage = document.getElementById('qrImage').src;
            const link = document.createElement('a');
            link.href = qrImage;
            link.download = 'qr-payment.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function copyAccountNumber() {
            const accountNumber = document.getElementById('accountNumber').textContent;
            navigator.clipboard.writeText(accountNumber).then(() => {
                showNotification('Nomor rekening berhasil disalin');
            });
        }
    </script>
</body>
</html>
